===================
后处理
===================

.. contents ::

提取质控标识
==============

为了了解质控的步骤和结果，可以使用如下几种方法提取质控码：

1. 执行 :code:`python` 脚本::

    > find /home/zwtd/nwprod/com/rap/prod -name "rap.t??z.prepbufr.tm00" -exec python read_qcf.py -f {} \;

提取的质控代码如下，如飞机观测:

.. note :: 
    
    PQM、QQM、TQM、ZQM、WQM、NUL、PWQ、PMQ **<=2** 代表质量较好的观测

.. code :: console

    CNCOVK1    116.47    29.60 2018-12-16 13:00:00 131 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 13.0 2.0 -- -- -- --]
    CNGOWP1    109.75    21.45 2018-12-16 13:00:00 131 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 13.0 2.0 -- -- -- --]
    CNGOWP1    109.28    21.77 2018-12-16 13:00:00 131 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 13.0 2.0 -- -- -- --]
    CNCOVK1    116.18    29.28 2018-12-16 13:00:00 131 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 13.0 2.0 -- -- -- --]
    CNFOSS1    117.90    29.45 2018-12-16 13:00:00 131 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 13.0 2.0 -- -- -- --]

如探空观测:

.. code :: console

    57447      109.47    30.28 2018-12-16 11:30:00 120 13
                 PQM QQM TQM ZQM WQM NUL PWQ PMQ
    01   974.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    02   925.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    03   850.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    04   700.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    05   500.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    06   400.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    07   389.00 [2.0 2.0 2.0 -- -- -- -- --]
    08   300.00 [2.0 2.0 2.0 2.0 -- -- -- --]
    09   250.00 [2.0 9.0 2.0 2.0 -- -- -- --]
    10   200.00 [2.0 9.0 2.0 2.0 -- -- -- --]
    11   150.00 [2.0 -- 2.0 2.0 -- -- -- --]
    12   105.00 [2.0 -- 2.0 -- -- -- -- --]
    13   100.00 [2.0 -- 2.0 2.0 -- -- -- --]
    57447      109.47    30.28 2018-12-16 11:30:00 220 37
                 PQM QQM TQM ZQM WQM NUL PWQ PMQ
    01   974.00 [2.0 -- -- -- 2.0 -- -- --]
    02   954.00 [2.0 -- -- -- 2.0 -- -- --]
    03   925.00 [2.0 -- -- -- 2.0 -- -- --]
    04   917.00 [2.0 -- -- -- 2.0 -- -- --]
    05   881.00 [2.0 -- -- -- 2.0 -- -- --]
    06   850.00 [2.0 -- -- -- 2.0 -- -- --]
    07   846.00 [2.0 -- -- -- 2.0 -- -- --]
    08   779.00 [2.0 -- -- -- 2.0 -- -- --]
    09   700.00 [2.0 -- -- -- 2.0 -- -- --]
    10   630.00 [2.0 -- -- -- 2.0 -- -- --]
    11   503.00 [2.0 -- -- -- 2.0 -- -- --]
    12   500.00 [2.0 -- -- -- 2.0 -- -- --]
    13   459.00 [2.0 -- -- -- 2.0 -- -- --]
    14   400.00 [2.0 -- -- -- 2.0 -- -- --]
    15   389.00 [2.0 -- -- -- 2.0 -- -- --]
    16   302.00 [2.0 -- -- -- 2.0 -- -- --]
    17   300.00 [2.0 -- -- -- 2.0 -- -- --]
    18   250.00 [2.0 -- -- -- 2.0 -- -- --]
    19   200.00 [2.0 -- -- -- 2.0 -- -- --]
    20   171.00 [2.0 -- -- -- 2.0 -- -- --]
    21   150.00 [2.0 -- -- -- 2.0 -- -- --]
    22   105.00 [2.0 -- -- -- 2.0 -- -- --]
    23   101.00 [2.0 -- -- -- 2.0 -- -- --]
    24   100.00 [2.0 -- -- -- 2.0 -- -- --]
    25    79.10 [2.0 -- -- -- 2.0 -- -- --]
    26    74.10 [2.0 -- -- -- 2.0 -- -- --]
    27    54.70 [2.0 -- -- -- 2.0 -- -- --]
    28    51.30 [2.0 -- -- -- 2.0 -- -- --]
    29    40.00 [2.0 -- -- -- 2.0 -- -- --]
    30    32.80 [2.0 -- -- -- 2.0 -- -- --]
    31    18.00 [2.0 -- -- -- 2.0 -- -- --]
    32    16.70 [2.0 -- -- -- 2.0 -- -- --]
    33    13.50 [2.0 -- -- -- 2.0 -- -- --]
    34    12.50 [2.0 -- -- -- 2.0 -- -- --]
    35    10.70 [2.0 -- -- -- 2.0 -- -- --]

如地面加密观测:

.. code :: console

    831870     103.97    30.48 2018-12-16 12:00:00 281 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- -- -- 2.0 -- -- --]
    831870     103.97    30.48 2018-12-16 12:00:00 181 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 2.0 2.0 -- -- -- --]
    857901      81.14    30.42 2018-12-16 12:00:00 281 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- -- -- 2.0 -- -- --]
    857901      81.14    30.42 2018-12-16 12:00:00 181 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 2.0 2.0 -- -- -- --]
    857902      81.15    30.40 2018-12-16 12:00:00 281 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- -- -- 2.0 -- -- --]
    857902      81.15    30.40 2018-12-16 12:00:00 181 01
    PQM QQM TQM ZQM WQM NUL PWQ PMQ
    [2.0 -- 2.0 2.0 -- -- -- --]



2. 执行 :code:`Fortran` 程序::

    > ln -fs  /nwprod/com/rap/prod/rap.20181216/rap.t12z.prepbufr.tm00 prepbufr
    > /nwprod/util/exec/bufrqc

.. note ::
    
     可以进入 :code:`/nwpprod/util/sorc/bufrqc.fd`，修改程序 :code:`prepbufr_decode_all_evn.f90` 以获得个性化输出。